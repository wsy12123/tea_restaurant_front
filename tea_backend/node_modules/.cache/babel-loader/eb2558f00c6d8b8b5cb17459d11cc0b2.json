{"remainingRequest":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\babel-loader\\lib\\index.js!D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\尚硅谷\\uniapp_storage\\tea_backend\\src\\components\\login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\src\\components\\login.vue","mtime":1671277012758},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667713506232},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\babel-loader\\lib\\index.js","mtime":1667713515975},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1667713506232},{"path":"D:\\尚硅谷\\uniapp_storage\\tea_backend\\node_modules\\vue-loader\\lib\\index.js","mtime":1667713514172}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\\\u5C1A\\u7845\\u8C37\\\\uniapp_storage\\\\tea_backend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { loginApi } from \"../api/login.js\";\nimport { mapi } from \"../assets/20221216191223639c5297f3d58.mp3\";\nexport default {\n  name: 'login',\n  el: '#login-app',\n  data: function data() {\n    return {\n      path: \"ws://localhost:8080/webSocket\",\n      socket: \"\",\n      loginForm: {\n        username: 'admin',\n        password: '123456'\n      },\n      loading: false\n    };\n  },\n  computed: {\n    loginRules: function loginRules() {\n      var validateUsername = function validateUsername(rule, value, callback) {\n        if (value.length < 1) {\n          callback(new Error('请输入用户名'));\n        } else {\n          callback();\n        }\n      };\n\n      var validatePassword = function validatePassword(rule, value, callback) {\n        if (value.length < 6) {\n          callback(new Error('密码必须在6位以上'));\n        } else {\n          callback();\n        }\n      };\n\n      return {\n        'username': [{\n          'validator': validateUsername,\n          'trigger': 'blur'\n        }],\n        'password': [{\n          'validator': validatePassword,\n          'trigger': 'blur'\n        }]\n      };\n    }\n  },\n  created: function created() {},\n  methods: {\n    handleLogin: function () {\n      var _handleLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this = this;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.$refs.loginForm.validate(\n                /*#__PURE__*/\n                function () {\n                  var _ref = _asyncToGenerator(\n                  /*#__PURE__*/\n                  regeneratorRuntime.mark(function _callee(valid) {\n                    var res;\n                    return regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            if (!valid) {\n                              _context.next = 6;\n                              break;\n                            }\n\n                            _this.loading = true;\n                            _context.next = 4;\n                            return loginApi(_this.loginForm);\n\n                          case 4:\n                            res = _context.sent;\n\n                            if (String(res.data.code) === '1') {\n                              console.log(\"11\");\n\n                              _this.init();\n\n                              localStorage.setItem('userInfo', JSON.stringify(res.data)); //进行路由\n\n                              _this.$router.push({\n                                path: '/member/index'\n                              });\n                            } else {\n                              console.log(\"222\");\n\n                              _this.$message.error(res.data.msg);\n\n                              _this.loading = false;\n                            }\n\n                          case 6:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function (_x) {\n                    return _ref.apply(this, arguments);\n                  };\n                }());\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleLogin() {\n        return _handleLogin.apply(this, arguments);\n      }\n\n      return handleLogin;\n    }(),\n    // websocket测试\n    init: function init() {\n      console.log(this.path);\n\n      if (typeof WebSocket === \"undefined\") {\n        alert(\"您的浏览器不支持socket\");\n      } else {\n        // 实例化socket\n        this.socket = new WebSocket(this.path); // 监听socket连接\n\n        this.socket.onopen = this.open; // 监听socket错误信息\n\n        this.socket.onerror = this.error; // 监听socket消息\n\n        this.socket.onmessage = this.getMessage;\n      }\n    },\n    open: function open() {\n      console.log(\"socket连接成功\");\n    },\n    error: function error() {\n      console.log(\"连接错误\");\n    },\n    getMessage: function getMessage(msg) {\n      console.log(msg.data);\n      var audio = new Audio();\n      audio.src = 'https://gitee.com/Bless_Wu/hometown/raw/master/20221216191223639c5297f3d58.mp3';\n      audio.play();\n    },\n    send: function send() {\n      var code = 4;\n      this.socket.send(code);\n    },\n    close: function close() {\n      console.log(\"socket已经关闭\");\n    }\n  }\n};",{"version":3,"sources":["login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div class=\"login\" id=\"login-app\">\r\n\t\t<div class=\"login-box\">\r\n\t\t\t<img src=\"../assets/login/login-l.png\" alt=\"\">\r\n\t\t\t<div class=\"login-form\">\r\n\t\t\t\t<el-form ref=\"loginForm\" :model=\"loginForm\" :rules=\"loginRules\">\r\n\t\t\t\t\t<div class=\"login-form-title\">\r\n\t\t\t\t\t\t<img src=\"../assets/login/logo.png\" style=\"width:139px;height:42px;\" alt=\"\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<el-form-item prop=\"username\">\r\n\t\t\t\t\t\t<el-input v-model=\"loginForm.username\" type=\"text\" auto-complete=\"off\" placeholder=\"账号\"\r\n\t\t\t\t\t\t\tmaxlength=\"20\" prefix-icon=\"iconfont icon-user\" />\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item prop=\"password\">\r\n\t\t\t\t\t\t<el-input v-model=\"loginForm.password\" type=\"password\" placeholder=\"密码\"\r\n\t\t\t\t\t\t\tprefix-icon=\"iconfont icon-lock\" maxlength=\"20\" @keyup.enter.native=\"handleLogin\" />\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t<el-form-item style=\"width:100%;\">\r\n\t\t\t\t\t\t<el-button :loading=\"loading\" class=\"login-btn\" size=\"medium\" type=\"primary\" style=\"width:100%;\"\r\n\t\t\t\t\t\t\t@click.native.prevent=\"handleLogin\">\r\n\t\t\t\t\t\t\t<span v-if=\"!loading\">登录</span>\r\n\t\t\t\t\t\t\t<span v-else>登录中...</span>\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t</el-form-item>\r\n\t\t\t\t</el-form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n\r\n\r\n\r\n<script>\r\n\timport {\r\n\t\tloginApi\r\n\t} from '../api/login.js'\r\n  import {\r\n\t  mapi\r\n  } from '../assets/20221216191223639c5297f3d58.mp3'\r\n\r\n\texport default {\r\n\t\tname: 'login',\r\n\t\tel: '#login-app',\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpath:\"ws://localhost:8080/webSocket\",\r\n\t\t\t\tsocket:\"\",\r\n\t\t\t\tloginForm: {\r\n\t\t\t\t\tusername: 'admin',\r\n\t\t\t\t\tpassword: '123456'\r\n\t\t\t\t},\r\n\t\t\t\tloading: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tloginRules() {\r\n\t\t\t\tconst validateUsername = (rule, value, callback) => {\r\n\t\t\t\t\tif (value.length < 1) {\r\n\t\t\t\t\t\tcallback(new Error('请输入用户名'))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tconst validatePassword = (rule, value, callback) => {\r\n\t\t\t\t\tif (value.length < 6) {\r\n\t\t\t\t\t\tcallback(new Error('密码必须在6位以上'))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\t\r\n\t\t\t\t\t'username': [{\r\n\t\t\t\t\t\t'validator': validateUsername,\r\n\t\t\t\t\t\t'trigger': 'blur'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\t'password': [{\r\n\t\t\t\t\t\t'validator': validatePassword,\r\n\t\t\t\t\t\t'trigger': 'blur'\r\n\t\t\t\t\t}],\r\n\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {},\r\n\t\tmethods: {\r\n\t\t\tasync handleLogin() {\r\n\t\t\t\tthis.$refs.loginForm.validate(async (valid) => {\r\n\t\t\t\t\tif (valid) {\r\n\t\t\t\t\t\tthis.loading = true\r\n\t\t\t\t\t\tlet res = await loginApi(this.loginForm)\r\n\r\n\t\t\t\t\t\tif (String(res.data.code) === '1') {\r\n\t\t\t\t\t\t\tconsole.log(\"11\")\r\n\t\t\t\t\t\t\tthis.init()\r\n\t\t\t\t\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(res.data))\r\n\t\t\t\t\t\t\t//进行路由\r\n\t\t\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\t\t\tpath: '/member/index'\r\n\t\t\t\t\t\t\t})\r\n\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log(\"222\")\r\n\t\t\t\t\t\t\tthis.$message.error(res.data.msg)\r\n\t\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// websocket测试\r\n\t\t\tinit: function () {\r\n\t\t\t\t\r\n\t\t\t\tconsole.log(this.path)\r\n\t\t\t    if(typeof(WebSocket) === \"undefined\"){\r\n\t\t\t        alert(\"您的浏览器不支持socket\")\r\n\t\t\t    }else{\r\n\t\t\t        // 实例化socket\r\n\t\t\t        this.socket = new WebSocket(this.path)\r\n\t\t\t        // 监听socket连接\r\n\t\t\t        this.socket.onopen = this.open\r\n\t\t\t        // 监听socket错误信息\r\n\t\t\t        this.socket.onerror = this.error\r\n\t\t\t        // 监听socket消息\r\n\t\t\t        this.socket.onmessage = this.getMessage\r\n\t\t\t    }\r\n\t\t\t},\r\n\t\t\topen: function () {\r\n\t\t\t    console.log(\"socket连接成功\")\r\n\t\t\t},\r\n\t\t\terror: function () {\r\n\t\t\t    console.log(\"连接错误\")\r\n\t\t\t},\r\n\t\t\tgetMessage: function (msg) {\r\n\t\t\t    console.log(msg.data)\r\n\t\t\t  let audio=  new Audio();\r\n\t\t\t  audio.src= 'https://gitee.com/Bless_Wu/hometown/raw/master/20221216191223639c5297f3d58.mp3';\r\n\t\t\t  audio.play()\r\n\t\t\t},\r\n\t\t\tsend: function () {\r\n\t\t\t\tlet code=4\r\n\t\t\t    this.socket.send(code)\r\n\t\t\t},\r\n\t\t\tclose: function () {\r\n\t\t\t    console.log(\"socket已经关闭\")\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/* @import '../styles/common.css'; */\r\n\t@import '../styles/login.css';\r\n</style>\n"],"sourceRoot":"src/components"}]}